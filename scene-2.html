<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Usefule metadata to be parsed and used by browsers-->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/scene-2.css">
    <!-- Link to CSS stylesheet -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <!-- Javascript files -->
    <script src="js/jquery-3.6.4.min.js"></script>
    <script src="js/jquery.ripples.js"></script>
    <script src="js/sound.js"></script>
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <title>Scene 2</title>
</head>
<body>
    <!-- audio to be played in scene  -->
    <audio src="audio/final/Chapter2-DiveIntoResurgence.mp3" id="sound" loop="loop" autoplay="autoplay" type="audio/mp3"></audio>
    <!-- div of scene elements  -->
    <div class="scene-2">  
        <!-- kid div -->
        <div class="kid" > 
            <a href="#">
                <img id="kid" src="img/kid-swimming.png" alt=""  width="70%">
            </a>
        </div>
        <!-- navigation div -->
        <div class="navigation">
            <a class="arrow-back" href="scene-1.html">
                <ion-icon name="arrow-back-circle-outline"></ion-icon>
            </a> 
            <a class="arrow-forward" href="scene-3.html">
                <ion-icon name="arrow-forward-circle-outline"></ion-icon>    
            </a>
        </div>
        <!-- instuctions div  -->
        <div class='instructions'> 
            <center>
                <h1 id="heading">
                    PRESS THE SPACE BAR TO MOVE SWIMMER!
                </h1>
            </center>
        </div>

    </div>


    <script>
        /* this function checks whether the element has gone off screen by checking if any of the 
        bounds of clientRec of the element are beyond the screen */
        function isElementOffScreen(element) {
        const rect = element.getBoundingClientRect();
        const viewWidth = window.innerWidth || document.documentElement.clientWidth;
        const viewHeight = window.innerHeight || document.documentElement.clientHeight;

        return (
            rect.bottom < 0 ||
            rect.right < 0 ||
            rect.left > viewWidth ||
            rect.top > viewHeight
        );
        }

        /* this function moves the kid element by 50 pixels everytime the space bar is pressed */
        function move() {
            if (event.keyCode === 32 || event.which === 32) {
                // code to be executed when space bar is pressed
                var kidpos = document.getElementById('kid').offsetLeft
                kidpos = kidpos + 50
                document.getElementById('kid').style.left = kidpos + 'px'
                if (isElementOffScreen(document.getElementById('kid'))) { // if the kid has gone off screen 
                    const myHeading = document.getElementById("heading");
                    myHeading.textContent = "YOU DID IT!"; // change text to "YOU DID IT! "
                    document.getElementById('kid').style.left = 0 // set the positon of the kid back to the start 
                    if (myHeading.textContent != "YOU DID IT!") { // stop moving the kid if the kid managed to get across the pool 
                        document.addEventListener('keydown', move)
                    } else {
                        document.removeEventListener('keydown', move) // remove event listener if the user successfully got the kid across the pool 
                    }
                }
            }
        }
        document.addEventListener('keydown', move); // add event listener on the document 
    </script>
</body>
</html>